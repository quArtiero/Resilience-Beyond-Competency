"""
Lesson 4: Self-Regulation - Calm on Command
Module 2: Emotional Intelligence
"""

lesson4_content = {
    'id': 23,
    'slug': 'self-regulation-calm-command',
    'title': 'Self-Regulation: Calm on Command',
    'module_number': 2,
    'order': 7,
    'is_published': True,
    'story': """## The Switch You Need When Stakes Are High

**3:47 PM, Q4 Review Meeting**

Marcus watches his carefully prepared slides get dismissed in 12 seconds. "This isn't what we need," the CEO says, turning to the next presenter.

His body floods with heat. Thoughts spiral: *Six weeks wasted. They think I'm incompetent. My promotion is gone.*

**Old Marcus** would have:
- Defended aggressively (making it worse)
- Shut down completely (missing the feedback)
- Ruminated for days (destroying his week)

**New Marcus** (after this lesson) does something invisible but powerful:
- **3:47:15** - Notices the heat wave (SIGNAL)
- **3:47:20** - Initiates 90-second reset under the table
- **3:48:00** - Reframes: "Data about expectations, not judgment"
- **3:48:30** - Asks one clarifying question: "What would make this valuable for you?"
- **3:49:00** - Takes notes on the real need
- **5:15 PM** - Sends revised framework
- **Next morning** - Gets "Much better. Run with this."

**Total recovery time**: 90 seconds to functional, 90 minutes to productive.
**Without the tools**: 3 days of rumination, damaged relationship.

### The Neuroscience of State Shifts

When triggered, your brain follows a predictable cascade:

1. **Amygdala hijack** (0-250ms): Threat detected, alarm sounds
2. **HPA axis activation** (1-3s): Cortisol and adrenaline flood
3. **Prefrontal shutdown** (3-10s): Executive function goes offline
4. **Default network activation** (10s+): Old patterns take over

But here's what most people don't know: **You have intervention windows at each stage.**

### The Master Equation

**Self-Regulation = Arousal Management + Cognitive Flexibility + Purposeful Action**

It's not about feeling less. It's about creating space between feeling and action so you can choose what serves your purpose.

### The Regulation Paradox

Most people try to regulate by:
- Suppressing feelings (backfires via "ironic rebound")
- Analyzing why they're upset (amplifies rumination)
- Waiting it out (wastes time and energy)

What actually works:
- **Accept the feeling** ("Of course I'm frustrated")
- **Shift the physiology** (breath, movement, temperature)
- **Reframe the meaning** (threat → challenge → data)
- **Act on purpose** (one tiny next step)

### Your Regulation Operating System

Think of regulation tools like apps on your phone. You don't need all of them all the time, but you need the right one instantly available.

**The Core Stack** (memorize these):

#### 1. The 90-Second Reset
Why 90 seconds? That's how long it takes for the neurochemical cascade to complete one cycle (Jill Bolte Taylor, 2006).

**The Protocol**:
- 5 breath cycles (4-4-4 or 5-5-5)
- Label precisely (2 words)
- State purpose (1 line)
- Choose next action (≤10 minutes)

**When to use**: First response to any trigger. Your default app.

#### 2. Grounding 5-4-3-2-1
Hijacks rumination by flooding sensory channels, forcing present-moment awareness.

**The Science**: Activates the ventromedial prefrontal cortex, which inhibits amygdala firing (Ochsner & Gross, 2005).

**When to use**: Panic, dissociation, pre-performance anxiety.

#### 3. Cognitive Reappraisal
Same facts, new frame. The most researched regulation strategy with 40+ years of validation.

**Reappraisal Prompts** (choose one):
- Threat → Challenge: "This is practice for..."
- Personal → Situational: "Anyone in this position would..."
- Permanent → Temporary: "This is today's challenge, not life's verdict"
- Pervasive → Specific: "This affects X, not everything"

**Meta-analysis finding**: Reappraisal reduces negative emotion by 0.45 SD and increases positive emotion by 0.38 SD (Webb et al., 2012).

#### 4. If-Then Implementation Intentions
Pre-decided responses that bypass the need for willpower under stress.

**Format**: If [specific cue], then I will [specific action <2 min].

**The Research**: Implementation intentions improve goal attainment by 0.65 SD - medium to large effect size (Gollwitzer & Sheeran, 2006).

### The Stress Inoculation Protocol

Navy SEALs use a 4-part system that we'll adapt:

1. **Arousal control** (breathing)
2. **Goal setting** (micro-goals under stress)
3. **Visualization** (mental rehearsal of regulation)
4. **Self-talk** (instructional, not emotional)

Your civilian version:
1. **Breathe** (4-7-8 pattern)
2. **Micro-goal** (next 10 minutes only)
3. **See yourself** executing your If-Then
4. **Instruct yourself** ("First X, then Y")

### Case Study: The Hostile Takeover

**Sarah from Lesson 3, now with regulation tools:**

**2:15 PM** - Email: "Moving your project to Jake's team. Effective immediately."

**Without tools**: Rage email → Bridge burned → Reputation damaged

**With regulation stack**:
- **2:15:30** - 90-second reset at desk
- **2:17:00** - Reappraisal: "Organizational need, not personal judgment"
- **2:18:00** - If-Then executes: "If project changes, then I request transition plan"
- **2:25:00** - Sends: "Understand the change. To ensure smooth transition, could we map dependencies and handoff timeline? Happy to lead the knowledge transfer."
- **Next day** - Promoted to lead new strategic initiative

**The difference**: She regulated to serve her purpose (career advancement), not her emotion (anger).

### The Regulation Ladder

Intensity determines tool selection:

**Level 1-3** (Mild): Self-talk correction
**Level 4-5** (Moderate): 90-second reset
**Level 6-7** (Significant): Grounding + Reset
**Level 8-9** (Severe): State switch + Grounding + Reset + Reappraisal
**Level 10** (Crisis): Remove yourself + Full protocol

### Your Personal Regulation Recipe

By lesson end, you'll have:
1. Your 90-second reset memorized and tested
2. Three If-Then plans for your triggers
3. Your go-to reappraisal frame
4. A measurement system for progress

Remember: **Regulation isn't about becoming emotionless. It's about becoming response-able.**

*Ready to install your calm-on-command system? Let's start with the 90-second reset...*""",
    
    'reflection': """## Your Regulation Lab

You've learned the theory. Now let's install the tools through deliberate practice.

### Drill 1: The 90-Second Reset

<regulation-reset-timer>

### Drill 2: Grounding 5-4-3-2-1

Practice the sensory grounding technique that interrupts rumination.

<grounding-exercise>

### Drill 3: Reappraisal Builder

Transform threatening thoughts into workable perspectives.

<reappraisal-builder>

### Integration Check

After practicing all three drills, answer:

**Which tool felt most natural?**
- [ ] 90-Second Reset
- [ ] Grounding 5-4-3-2-1  
- [ ] Cognitive Reappraisal

**Your personal stack** (order them 1-2-3):
1. ________________
2. ________________
3. ________________

**One situation where you'll test this week**: 
_________________________________

### The Compound Effect

- One reset per day = 365 recovered moments per year
- One reappraisal per trigger = 50% less rumination
- One If-Then executed = 65% higher goal achievement

### Your Commitment

Complete this statement:
"When I notice [body signal], I will [specific tool] within [seconds], then take [specific action]."

### Track Your Progress

Over the next week, measure:
- Time from trigger to baseline (aim: <5 minutes)
- Stress level pre/post reset (aim: 2-point drop)
- If-Then execution rate (aim: 80%)

Record at least 3 regulation moments this week.""",
    
    'challenge': """## Your Regulation Challenge Lab

### Part 1: If-Then Plan Factory

<if-then-planner>

### Part 2: Mini-Case Simulations

Practice regulation in realistic scenarios.

<regulation-simulator>

### Part 3: Your Personal Protocol Card

<protocol-card-builder>

### Part 4: State Switch Tracker

<state-switch-tracker>

### 7-Day Regulation Challenge

**Daily Practice** (10 minutes):
- Morning: Set one If-Then intention
- Trigger moment: Execute your protocol
- Evening: Log the outcome

**Success Metrics**:
- 1+ regulation moment logged daily
- Stress drops by 2+ points post-reset
- Recovery time <5 minutes by day 7

**Bring to Lesson 5**:
- Your best If-Then line that worked
- One story where regulation changed the outcome
- Your average recovery time

### The Accountability System

Share with someone:
"My go-to regulation tool is _____ and I'm tracking _____."

Ask them to check on Day 3:
"How many times did you catch and regulate today?"

### Exit Reflection

**Complete these**:
1. "My fastest regulation tool is _____ because _____"
2. "My most challenging trigger to regulate is _____"
3. "If I master this one skill, it will save me _____ hours/week"
4. "Tomorrow I'll practice when _____"

*Remember: Every regulated moment is a victory. Start with just one today.*""",
    
    'quiz': """{"questions":[{"id":1,"type":"multiple_choice","text":"First move when you notice tunnel vision?","options":["Send the email faster","Run a 90-second reset or 5-4-3-2-1","Open more tabs","Argue your case"],"correct":1,"explanation":"Lower arousal before deciding. Tunnel vision indicates high stress - you need to regulate before taking action."},{"id":2,"type":"multiple_choice","text":"Reappraisal is best described as...","options":["Denying the facts","Changing the meaning while keeping the facts","Venting privately","Waiting it out"],"correct":1,"explanation":"Same facts, new frame. Reappraisal changes interpretation, not reality."},{"id":3,"type":"multiple_choice","text":"A strong If-Then plan must be...","options":["Inspirational","General and flexible","Tiny, specific, executable in <2 min","Aggressive and bold"],"correct":2,"explanation":"Precision makes it runnable under stress. Vague plans fail when you need them most."},{"id":4,"type":"multiple_choice","text":"Which stack best fits a hostile email?","options":["Reply immediately → CC everyone","Grounding → Reappraisal → Purpose → 4-bullet reply with one Next","Delete the thread","Escalate to leadership"],"correct":1,"explanation":"Regulate, then respond with purpose. This prevents reactive damage."},{"id":5,"type":"multiple_choice","text":"Attentional zoom: when scattered, you should...","options":["Widen to more inputs","Narrow to one 25-min block and a two-minute anchor","Multitask two things","Wait for motivation"],"correct":1,"explanation":"Narrowing reduces cognitive load and restores control when overwhelmed."}]}"""
}

# Helper functions for database operations
def get_lesson4_content():
    """Returns the complete lesson 4 content dictionary"""
    return lesson4_content

if __name__ == "__main__":
    import json
    print(f"Lesson 4: {lesson4_content['title']}")
    print(f"ID: {lesson4_content['id']}")
    print(f"Module: {lesson4_content['module_number']}")
    print(f"Story length: {len(lesson4_content['story'])} characters")
    print(f"Quiz questions: {len(json.loads(lesson4_content['quiz'])['questions'])}")
